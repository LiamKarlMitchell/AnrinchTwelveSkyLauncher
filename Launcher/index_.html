<html>
<head>
<title>Launcher</title>
<body>
<h1>Woo</h1>

<script>
// TODO: Get latest TSX Client release from https://help.github.com/articles/linking-to-releases/
// Look into having releases in zip https://help.github.com/articles/creating-releases/
// also where required have a delete.txt file which lists files or directories to delete from data/ before unpacking data dir.
// see about a way to send info from server in init packet about the previous build/tag it was from.
// get change notes from github releases page, https://developer.github.com/v3/repos/releases/
// Should be able to choose to view patch notes of, Server (That you would connect to if its online), InfiniteSky Project, Launcher, TSX Client, translation data, Korean Patch Notes
// Add an option to keep downloaded patches
// Add an option to clear downloaded patches
// track the release version of TSX Client if newer update it
//
// PATCH ORDERING
// Download latest launcher exe first if it is different to current version exit launcher run game. If we use the file name old launcher used it will patch over for us and relaunch the launcher.
// Download korean patches up to date, split out the exe's > a predetermined patch number into an exe directory. (Latest exe becomes TwelveSky.exe)
// If exe specified in config is not TwelveSky.exe such as TwelveSky_107.exe TwelveSky_[0-9]+\.exe then  use that exe if it exists in the exe directory.
// TSX Client
// Translation Files

// GAME START:
// if patches are all done
// Launch exe but set working directory to the Launchers working directory.

// Load native UI library
var gui = require('nw.gui');
var fs = require('fs');
var path = require('path');
var configFile = path.join(process.cwd(),'../config.json');
var config = {};

fs.exists(configFile, function (exists) {
  if (exists) {
    config = require(configFile);
    doPatches();
  } else {
    alert(configFile+' not found.');
    gui.App.quit();
  }
});

var Ping = require('ping-wrapper');
Ping.configure();

var ping = new Ping('127.0.0.1');

var count = 0;
ping.on('ping', function(data){
    console.log('Ping %s: time: %s ms', data.host, data.time);
    count ++;

    if (count > 10) {
      ping.stop();
    }
});

ping.on('fail', function(data){
    console.log('Fail', data);
});

function doPatches() {

}

var bgm_path = '../G03_GDATA/D11_WORLDBGM/';
var songs = [{ id: Z000.BGM, name: 'Server Select' },
             { id: Z001.BGM, name: 'Draw the sword' },
             { id: Z002.BGM, name: '' },
             { id: Z003.BGM, name: '' },
             { id: Z004.BGM, name: '' },
             { id: Z005.BGM, name: 'Burn! your soul' },
             { id: Z006.BGM, name: 'Battlefield' },
             { id: Z007.BGM, name: 'No easy way out' },
             { id: Z008.BGM, name: '' },
             { id: Z011.BGM, name: '' },
             { id: Z037.BGM, name: 'Enemies on every side' },
             { id: Z038.BGM, name: '' },
             { id: Z043.BGM, name: '' },
             { id: Z055.BGM, name: 'Beoho Mountain' },
             { id: Z081.BGM, name: '' },
             { id: Z091.BGM, name: '' },
             { id: Z143.BGM, name: '' }];

</script>

<audio controls>
  <source src="../G03_GDATA/D11_WORLDBGM/Z003.BGM" type="audio/ogg">
  Your browser does not support the audio tag.
</audio>

</body>
</html>
